%
% PROJECT: <ETD> Electronic Thesis and Dissertation Initiative
%   TITLE: LaTeX report template for ETDs in LaTeX
%  AUTHOR: Neill Kipp, nkipp@vt.edu
%     URL: http://etd.vt.edu/latex/
% SAVE AS: etd.tex
% REVISED: September 6, 1997 [GMc 8/30/10]
% 

% Instructions: Remove the data from this document and replace it with your own,
% keeping the style and formatting information intact.  More instructions
% appear on the Web site listed above.

\documentclass[12pt,dvips]{report}

\setlength{\textwidth}{6.5in}
\setlength{\textheight}{8.5in}
\setlength{\evensidemargin}{0in}
\setlength{\oddsidemargin}{0in}
\setlength{\topmargin}{0in}

\setlength{\parindent}{0pt}
\setlength{\parskip}{0.1in}

% Uncomment for double-spaced document.
% \renewcommand{\baselinestretch}{2}

% \usepackage{epsf}

% BHH Packages
\usepackage[]{mcode}
\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage{amsmath}
\usepackage{amssymb}


\begin{document}

\thispagestyle{empty}
\pagenumbering{roman}
\begin{center}

% TITLE
{\large
Simulation of Various Channelizer Structures 
Directed by Cyclostationary Detector}

\vfill

Brian H. Hulette

\vfill

Project Report submitted to the Faculty of the \\
Virginia Polytechnic Institute and State University \\
in partial fulfillment of the requirements for the degree of

\vfill

Master of Engineering \\
in \\
Electrical Engineering

\vfill

Amir I. Zaghloul, Co-Chair \\
Jeffrey H. Reed, Co-Chair \\
T. Charles Clancy

\vfill

February 16, 2015 \\
Falls Church, Virginia

\vfill

Keywords: Metaphysics, Information Retrieval, Spacecraft
\\
Copyright 2015, Brian H. Hulette

\end{center}

\pagebreak

\thispagestyle{empty}
\begin{center}

{\large Simulation of Various Channelizer Structures 
Directed by Cyclostationary Detector}

\vfill

Brian H. Hulette

\vfill

(ABSTRACT)

\vfill

\end{center}

A common problem in Software-Defined Radio (SDR) systems is the problem of
detecting and tuning narrow signals of interest in acquired wideband data. This
involves using some means to detect the frequency of one or more signals of
interest and then tuning, filtering, and decimating them. This problem is
particularly challenging due to the high sample rate of this wideband data,
so efficient algorithms are very desirable.

A MATLAB simulation of an SDR framework for detecting and subband tuning
channelized signals is presented.  Detection is performed using the
spectral-correlation density function [gardner].  These detections are then used to direct
a channelizer which will tune, filter, and decimate all of the detected signals.
Two different channelizer structures are examined - a polyphase
analysis/synthesis channelizer [harris] and an overlap-save filter bank
[Borgerding]. This framework has applications in both Cognitive Radio and
Electronic Warfare.

A summary of relevant background information is provided.  This includes a
discussion of cyclostationarity and the spectral-correlation density function
as well as background on both channelizer structures. For the overlap-save
filter bank it will be shown that in many cases computation can be saved by
re-using the FFT computed for the cyclostationary detector.

In this simulation simple QPSK signals are used to model the signals of 
interest, but the framework is applicable to any modulation or signal type
that has cyclostationary features - which is true of most digital signals. 
While other means of signal detection may be more reliable for specific signals,
a cyclostationary detector's primary strength is its ability to function for many
different digital signals.

\vfill

% GRANT INFORMATION

%That this work received support from the Southeastern Universities
%Research Association (SURA) ``Monticello Library Project'' is purely
%coincidental.

\pagebreak

% Dedication and Acknowledgments are both optional
% \chapter*{Dedication}
\chapter*{Acknowledgments}
I would like to acknowledge the work of both Craig Carlson and Ruth Stoehr. Much of the source for this project for both generating and processing a simple 
QPSK signal came from the ECE5654 project which we completed in the Spring 
of 2013.

I would like to thank my current employer, n~ask, inc., and all of my co-workers
there for their support.

I would also like to thank the members of my committee, particularly Dr.
Zaghloul, for their seemingly endless patience and support.

Finally I would like to thank my friends and family, particularly my girlfriend Meredith, for letting me use ``My Master's" as an excuse for nearly anything.

\tableofcontents
\pagebreak

\listoffigures
\pagebreak

\listoftables
\pagebreak

\pagenumbering{arabic}
\pagestyle{myheadings}

\chapter{Introduction}
\label{sec:intro}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:intro}. Introduction \hfill}

A common problem when designing a Software-Defined Radio (SDR) system is the
problem of detecting and tuning signals of interest. A typical SDR will sample
at a relatively high rate to acquire a wideband signal. Then it will attempt to
detect the channels within the acquired frequency range that contain signals of
interest, and then tune, filter, decimate, and demodulate those signals. 

%TODO: links to SDR frameworks (webSDR)
%TODO: image of SDR plotting
Many popular SDR applications perform this detection step with a
"man-in-the-loop".  A falling raster of the wideband data is presented and the
man-in-the-loop will "click-tune" to select  the frequencies that (s)he would
like to process. One common version of this is to acquire a wideband slice of
the HAM radio spectrum and then click tune to different frequencies to
demodulate new FM Push-to-Talk signals and listen to them.

In this paper I will investigate and simulate a structure that automates this
process - but rather than working for a single analog signal, this framework is
intended for an arbitrary number of digital signals. Detection is performed by
a cyclostationary detector rather than by a man-in-the-loop, in order to exploit
the cyclostationary properties exhibited by most digital signals with a fixed
symbol rate.  Tuning, filtering, and decimating is performed by a channelizer, so
that many signals can be processed at once.  I will examine two different
channelizer structures. They will be compared on two important criteria:
1) Their ability to accurately reproduce every detected signal, and 2) Their
computational efficiency when combined with a cyclostationary detector.

In Chapter~\ref{sec:cyclo} I will provide background information on
cyclostationary properties and the cyclic spectra upon which my detector relies.
Chapter~\ref{sec:chan} discusses and compares both of the channelizer structures
that I will simulate. Chapter~\ref{sec:sim}  discusses the MATLAB simulation I 
have created and the results of it. Finally, Chapter~\ref{sec:source} provides
annotated source code for key parts of the simulation, as well as locations
where the entire source code can be found.

\chapter{Cyclostationary Detection}
\label{sec:cyclo}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:cyclo}. Cyclostationary Detection \hfill}

\section{Cyclostationarity}
\label{sec:cyclo_prop}
Often signals are modeled as stochastic random processes with properties such as
mean and variance, but many man-made signals, particularly digital communications,
can be modeled with another statistical property called
\emph{cyclostationarity} which implies the signal has some parameter which
varies with time. The frequency of this variation is called the cyclic
frequency, $\alpha$. \cite{Gardner1}.

% Gardner1 = Exploitation of Spectral Redundancy in Cyclostationary Signals
% Oner1 = Cyclostationarity Based Air Interface Recognition for Software Radio Systems
% Gardner2 = Spectral Correlation of Modulated Signals: Part II - Digital Modulation

Of particular interest is second-order cyclostationarity, where a signal has a
periodic autocorrelation:

\begin{IEEEeqnarray*}{lCl}
    R_{xx}(t, t+\tau) = E\{x(t)x^*(t+\tau)\} = \sum_{\alpha} R_{xx}^{\alpha}(\tau)e^{j2 \pi \alpha t}
\end{IEEEeqnarray*}

% TODO more detail here based on Oner1

\begin{IEEEeqnarray*}{lCl}
    R_{xx}^{\alpha}(\tau) = \lim_{T \to \infty} \frac{1}{T}\int_{-T/2}^{T/2} R_{xx}(t, t+\tau)e^{-j2\pi \alpha t} dt
\end{IEEEeqnarray*}
% TODO: reference papers that perform time domain detection (listed in "Energy Efficient Spectrum Sensing using Cyclostationarity")
% "Cyclostationary Based Air Interface Recognition For Software Radio Systems" is also a time domain approach
The cyclic autocorrelation function (CAF), given by $R_{xx}^{\alpha}(\tau)$, can
be used for signal detection in the time domain. An estimate of the 2D function
versus $\alpha$ and $\tau$ can be computed, then features within this plane can be
detected. However, what I am interested in is the fourier transform of the CAF,
called the Spectral Correlation Density (SCD):

\begin{IEEEeqnarray*}{lCl}
    S_{xx}(\alpha, f) = \int_{-\infty}^{\infty} R_{xx}^{\alpha}(\tau)e^{-j2\pi f \tau} d\tau
\end{IEEEeqnarray*}

The SCD is a generalization of the conventional PSD, which it reduces to at $\alpha=0$
\cite{Oner1}. Like the CAF, the SCD also contains unique features based on the modulation
type, symbol rate, and carrier frequency of the transmitted signal, which we can
exploit for signal detection. In \cite{Gardner2}, Gardner defines this SCD for
various basic modulation types, including QPSK, which is used in my simulation.

%\section{Exploiting Cyclostationarity for Detection}
%\label{sec:exploit_cyc}
%For the problem defined in Chapter \ref{sec:intro} we can define the wideband
%signal $W(t)$ as the sum of $N$ cyclostationary signals, tuned to
%various frequencies, in an AWGN channel:
%\begin{IEEEeqnarray*}{lCl}
%    W(t) & = & \sum C_{i}(t) e^{j 2 \pi f_i t} + N(t)
%\end{IEEEeqnarray*}
%
%Where the $C_i(t)$ are cyclostationary random processes at various symbol rates,
%tuned to corresponding frequencies $f_i$ and $N(t)$ is the AWGN.
%
%We would like to exploit the cyclostationarity of the $C_i$ waveforms to
%identify the frequency, $f_i$, of those waveforms which are transmitted at a
%specific symbol rate.

\section{Estimating the SCD}
% Use Gardner1 to show that SCD is conjugate multiplication of frequency shifted spectra

% Discuss possibility of circular shifting a forward FFT to estimate SCD slice


\chapter{Channelizer Structures}
\label{sec:chan}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:chan}. Channelizer Structures\hfill}
\section{Polyphase Analysis/Synthesis Channelizer}
\label{sec:poly_chan}

\section{Overlap-save Filter Bank}
\label{sec:filter_bank}

\chapter{Simulation}
\label{sec:sim}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:sim}. Simulation \hfill}

\chapter{Results}
\label{sec:results}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:results}. Results \hfill}

%%%%%%%%%%%%%%%%%
%
% Include an EPS figure with this command:
%   \epsffile{filename.eps}
%

%%%%%%%%%%%%%%%%
%
% Do tables like this:

 \begin{table}
 \caption{The Graduate School wants captions above the tables.}
\begin{center}
 \begin{tabular}{ccc}
 x & 1 & 2 \\ \hline
 1 & 1 & 2 \\
 2 & 2 & 4 \\ \hline
 \end{tabular}
\end{center}
 \end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% If you are using BibTeX, uncomment the following:
% \thebibliography
%
% Otherwise, uncomment the following:
% \chapter*{Bibliography}

% \appendix

% In LaTeX, each appendix is a "chapter"
\chapter{Project Source}
\label{sec:source}
\markright{Brian H. Hulette \hfill Chapter \ref{sec:source}. Project Source \hfill}
% TODO: make sure this is a link - and make the project public!
The full source is hosted on GitHub (\texttt{https://github.com/TheNeuralBit/cyclo\_channelizer}), but I will include some of the critical files below.

\section{\texttt{cyclic\_spectrum.m}}
\lstinputlisting{../cyclic_spectrum.m}
\section{\texttt{synthesis\_channelizer.m}}
\lstinputlisting{../synthesis_channelizer.m}
\section{\texttt{analysis\_channelizer.m}}
\lstinputlisting{../analysis_channelizer.m}

\end{document}
